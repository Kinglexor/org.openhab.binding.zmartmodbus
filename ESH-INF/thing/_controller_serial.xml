<?xml version="1.0" encoding="UTF-8"?>
<thing:thing-descriptions bindingId="zmartmodbus"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:thing="http://eclipse.org/smarthome/schemas/thing-description/v1.0.0"
    xsi:schemaLocation="http://eclipse.org/smarthome/schemas/thing-description/v1.0.0 http://eclipse.org/smarthome/schemas/thing-description-1.0.0.xsd">

    <bridge-type id="serialbridge">
        <label>ModBus Serial Controller</label>
        <description>Modbus controller port with RS 485 Serial Interface</description>

        <channels>
            <channel id="message_count" typeId="counter" >
                <label>Modbus Messages Count</label>
                <description>Counting the number of Modbus Messages sent/received since last restart</description>
            </channel>
            <channel id="resptout_count" typeId="counter" >
                <label>Modbus Response Time-out</label>
                <description>Number of Modbus time-out errors recieved since last restart</description>
            </channel>
            <channel id="update_counter" typeId="switch_binary">
                <label>Enable counters</label>
                <description>Enable event update of counters - counters are running anyway</description>
            </channel>
        </channels>

        <config-description>
            <parameter-group name="port">
                <context>communication</context>
                <label>Port Configuration</label>
                <description></description>
            </parameter-group>

            <parameter-group name="modbusslaves">
                <context>modbudsslaves</context>
                <label>Modbus slaves</label>
                <description></description>
            </parameter-group>

            <parameter-group name="actions">
                <context>actions</context>
                <label>Modbus actions</label>
                <description></description>
            </parameter-group>

            <parameter name="serialport" type="text" required="true" groupName="port">
                <label>Serial Port</label>
                <description>Set the serial port used to access the Modbus device</description>
                <default>/dev/ttyS0</default>
            </parameter>

            <parameter name="baudrate" type="integer" required="true" groupName="port">
                <label>Baud rate</label>
                <description>Set the baud rate for the port</description>
                <default>38400</default>
                <advanced>false</advanced>
                <limitToOptions>true</limitToOptions>
                <options>
                    <option value="2400">2400</option>
                    <option value="4800">4800</option>
                    <option value="9600">9600</option>
                    <option value="19200">19200</option>
                    <option value="38400">38400</option>
                    <option value="56000">56000</option>
                    <option value="57600">57600</option>
                    <option value="115200">115200</option>
                    <option value="128000">128000</option>
                </options>                
            </parameter>

           <parameter name="databits" type="integer" required="true" groupName="port">
                <label>Data bits</label>
                <description>Set number of data bits for the port</description>
                <default>8</default>
                <advanced>false</advanced>
                <limitToOptions>true</limitToOptions>
                <options>
                    <option value="7">7 Databits</option>
                    <option value="8">8 Databits</option>
                </options>                
            </parameter>

           <parameter name="stopbits" type="integer" required="true" groupName="port">
                <label>Stop bits</label>
                <description>Set number of stop bits for the port</description>
                <default>1</default>
                <advanced>false</advanced>
                <limitToOptions>true</limitToOptions>
                <options>
                    <option value="1">1   Stopbit</option>
                    <option value="3">1,5 Stopbits</option>
                    <option value="2">2   Stopbit</option>
                </options>                
            </parameter>

           <parameter name="parity" type="integer" required="true" groupName="port">
                <label>Parity</label>
                <description>Set parity for the port</description>
                <default>0</default>
                <advanced>false</advanced>
                <limitToOptions>true</limitToOptions>
                <options>
                    <option value="2">Even</option>
                    <option value="3">Mark</option>
                    <option value="1">Odd</option>
                    <option value="0">None</option>
                </options>                
            </parameter>

           <parameter name="txmode" type="text" required="true" groupName="port">
                <label>Transmission mode</label>
                <description>Transmission mode RTU / BIN</description>
                <default>RTU</default>
                <advanced>false</advanced>
                <limitToOptions>true</limitToOptions>
                <options>
                    <option value="RTU">RTU</option>
                    <option value="ASCII">BIN</option>
                </options>                
            </parameter>

           <parameter name="slowpoll" type="integer" required="true" groupName="port" min="1000" max="720000">
                <label>Slow polling interval</label>
                <description>Slow polling interval in milliseconds</description>
                <default>60000</default>
                <advanced>false</advanced>
                <limitToOptions>true</limitToOptions>
                <options>
                    <option value="10000">10 seconds</option>
                    <option value="30000">30 seconds</option>
                    <option value="60000">1 minute</option>
                    <option value="120000">2 minutes</option>
                    <option value="300000">5 minutes</option>
                    <option value="900000">15 minutes</option>
                    <option value="1800000">30 minutes</option>
                    <option value="3600000">1 hour</option>
                </options>                
            </parameter>
            
           <parameter name="fastpoll" type="integer" required="true" groupName="port" min="200" max="60000">
                <label>Fast polling interval</label>
                <description>Fast polling interval in milliseconds</description>
                <default>10000</default>
                <advanced>false</advanced>
                <limitToOptions>true</limitToOptions>
                <options>
                    <option value="2000">2 seconds</option>
                    <option value="5000">5 seconds</option>
                    <option value="10000">10 seconds</option>
                    <option value="30000">30 seconds</option>
                    <option value="60000">1 minute</option>
                    <option value="120000">2 minutes</option>
                    <option value="300000">5 minutes</option>
                </options>                
            </parameter>
            

            <parameter name="controller_softreset" type="integer" groupName="actions">
                <label>Soft Reset Controller</label>
                <description>Resets the Z-Wave stick - similar to removing the stick from the USB.</description>
                <advanced>true</advanced>
                <default>0</default>
                <options>
                    <option value="-232323">send</option>
                </options>
            </parameter>


            <parameter name="controller_hardreset" type="integer" groupName="actions">
                <label>Hard Reset Controller</label>
                <description>Hard resets the Z-Wave stick - this will erase all configuration from the controller!</description>
                <advanced>true</advanced>
                <default>0</default>
                <options>
                    <option value="-232323">send</option>
                </options>
            </parameter>

            <parameter name="controller_exclude" type="integer" groupName="actions">
                <label>Exclude Devices</label>
                <description>Puts the controller into Exclusion mode.</description>
                <advanced>true</advanced>
                <default>0</default>
                <options>
                    <option value="-232323">send</option>
                </options>
            </parameter>

            <parameter name="controller_sync" type="integer" groupName="actions">
                <label>Synchronize network</label>
                <description>Download the network with the SUC</description>
                <advanced>true</advanced>
                <default>0</default>
                <options>
                    <option value="-232323">send</option>
                </options>
            </parameter>
            
            <parameter name="slave_jablotronac116" type="integer" groupName="modbusslaves">
                <label>AC-116 Unit Address</label>
                <description>Jablotron AC-116 / Wavin hydronic floor heating - Off or unit address</description>
                <default>0</default>
                <limitToOptions>true</limitToOptions>
                <options>
                    <option value="0">Off</option>
                    <option value="1">On (unit address 1)</option>
                    <option value="2">On (unit address 2)</option>
                    <option value="3">On (unit address 3)</option>
                    <option value="4">On (unit address 4)</option>
                    <option value="5">On (unit address 5)</option>
                    <option value="6">On (unit address 6)</option>
                    <option value="7">On (unit address 7)</option>
                </options>
            </parameter>            

            <parameter name="slave_nilancomfort300" type="integer" groupName="modbusslaves">
                <label>Nilan C300 Unit Address</label>
                <description>Nilan Comfort 300 Air Ventilation - Off or unit address</description>
                <default>0</default>
                <limitToOptions>true</limitToOptions>
                <options>
                    <option value="0">Off</option>
                    <option value="1">On (unit address 1)</option>
                    <option value="2">On (unit address 2)</option>
                    <option value="3">On (unit address 3)</option>
                    <option value="4">On (unit address 4)</option>
                    <option value="5">On (unit address 5)</option>
                    <option value="6">On (unit address 6)</option>
                    <option value="7">On (unit address 7)</option>
                </options>
            </parameter>            
 
         </config-description>
    </bridge-type>

</thing:thing-descriptions>
